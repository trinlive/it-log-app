<%
    // 1. Config สำหรับ Status
    const statusConfig = {
        'fix':          { label: 'helpdesk.fix',       order: 1 },
        'claim':        { label: 'helpdesk.claim',     order: 2 },
        'closed':       { label: 'helpdesk.closed',    order: 3 },
        'cancel':       { label: 'helpdesk.cancel',    order: 4 },
        'เรียบร้อย':    { label: 'permission.success', order: 5 },
        'ยกเลิก':       { label: 'permission.cancel',  order: 6 },
        'รอเจ้าหน้าที่ IT ดำเนินการ': { label: 'cctv.pending', order: 7 },
        'เสร็จสิ้น':    { label: 'cctv.success',       order: 8 },
        'ดราฟ':         { label: 'cctv.draft',         order: 9 }
    };

    // 2. Config สำหรับ Category
    const categoryConfig = {
        // --- Permission ---
        'ลงทะเบียนพนักงานใหม่':             { label: 'permission.registerUser', order: 1 },
        'Admin Social Media':               { label: 'permission.social',       order: 2 },
        'Drive Center':                     { label: 'permission.NasDrive',     order: 3 },
        'Email':                            { label: 'permisssion.email',       order: 4 },
        'Cloud Drive Center (Shared drives)':{ label: 'permission.Gdrive',      order: 5 },
        'LINE':                             { label: 'permission.line',         order: 6 },
        'SSH-KEY':                          { label: 'permission.ssh',          order: 7 },
        'USB Thumdrive':                    { label: 'permission.thumbDrive',   order: 8 },
        'WIFI':                             { label: 'permission.wifi',         order: 9 },
        'VPN':                              { label: 'permission.vpn',          order: 10 },
        'Vender Support':                   { label: 'permission.vender',       order: 11 },
        'Remote Desktop':                   { label: 'permission.remoteDesktop',order: 12 },

        // --- Helpdesk ---
        'Computer':                         { label: 'helpdesk.computer',       order: 13 },
        'Computers':                        { label: 'helpdesk.computer',       order: 13 },
        'Internet':                         { label: 'helpdesk.internet',       order: 14 },
        'Laptops':                          { label: 'helpdesk.laptop',         order: 15 },
        'Laptop':                           { label: 'helpdesk.laptop',         order: 15 },
        'Network':                          { label: 'helpdesk.network',        order: 16 },
        'Other':                            { label: 'helpdesk.other',          order: 17 },
        'Printers':                         { label: 'helpdesk.printer',        order: 18 },
        'Printer':                          { label: 'helpdesk.printer',        order: 18 },
        'Recovery Data':                    { label: 'helpdesk.recoveryData',   order: 19 },
        'SAP':                              { label: 'helpdesk.sap',            order: 20 },
        'Scaner':                           { label: 'helpdesk.scaner',         order: 21 },
        'Scanner':                          { label: 'helpdesk.scaner',         order: 21 },
        'Software':                         { label: 'helpdesk.software',       order: 22 },
        'UPS':                              { label: 'helpdesk.ups',            order: 23 },

        // --- CCTV ---
        'CCTV':                             { label: 'cctv.cctv',               order: 24 },
        'ขอดูย้อนหลัง':                     { label: 'cctv.playback',           order: 25 },
        'ขอติดตั้ง':                        { label: 'cctv.install',            order: 26 },
        'ขอย้ายจุดติดตั้ง':                 { label: 'cctv.move',               order: 27 }
    };

    // Helpers
    function getStatusLabel(status) {
        const s = (status || '').trim();
        return statusConfig[s] ? statusConfig[s].label : s;
    }
    function getStatusOrder(status) {
        const s = (status || '').trim();
        return statusConfig[s] ? statusConfig[s].order : 999;
    }
    function getCategoryLabel(cat) {
        const c = (cat || '').trim();
        return categoryConfig[c] ? categoryConfig[c].label : c;
    }
    function getCategoryOrder(cat) {
        const c = (cat || '').trim();
        return categoryConfig[c] ? categoryConfig[c].order : 999;
    }
    function formatDate(dateString) {
        if (!dateString) return '-';
        const d = new Date(dateString);
        const day = String(d.getDate()).padStart(2, '0');
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const year = String(d.getFullYear()).slice(-2);
        const hour = String(d.getHours()).padStart(2, '0');
        const min = String(d.getMinutes()).padStart(2, '0');
        return `${day}.${month}.${year} ${hour}:${min}`;
    }
%>